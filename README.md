# DFIR-Incident-Replication-Forensic-Analysis
    DFIR investigation reconstructing a full attack lifecycle. Correlated network (Security Onion), memory (Volatility 3), and disk (Autopsy) artifacts to map adversary techniques to MITRE ATTACK and develop playbook-driven response strategies. This project simulates a realistic end-to-end cyber attack scenario, followed by a comprehensive Digital Forensics and Incident Response (DFIR) investigation to reconstruct the entire event. 

The primary objective was to compromise a vulnerable machine, execute diverse post-exploitation activities (including privilege escalation, file manipulation, and SQL injection), and then perform a thorough forensic analysis on the network, memory, and hard disk artifacts. This investigation highlights the significance of continuous monitoring and proactive forensic analysis in identifying and mitigating modern cyber threats.

### Skills Learned

- Digital Forensic Analysis: Mastery of memory (Volatility 3), network (Security Onion/Wireshark), and disk (Autopsy) forensic techniques.

- Incident Response Lifecycle: Applied structured methodologies for evidence capture, analysis, and post-incident reporting.

- Threat Detection & Hunting: Used SIEM/IDS tools (Security Onion) for real-time traffic monitoring and anomaly detection, including mapping malicious activities to the MITRE ATT&CK framework.

- Log Analysis & Visualization: Leveraged Kibana for detailed visualization and correlation of network logs, and Cyberchef for translating and refining data related to exploitation attempts (e.g., SQL injection).

- Ethical Exploitation: Replicated common attack vectors (e.g., ProFTPD, SQL Injection) to understand adversary behavior and improve defensive measures.

### Tools Used

- Network Monitoring & Analysis: Security Onion, Snort IDS, Wireshark

- Memory Forensics: Volatility 3

- Hard Disk Forensics: Autopsy

- Attacking & Reconnaissance: Kali Linux, Nmap, Metasploit, Hashcat

- Data Processing: Cyberchef

- Visualization & Logging: Kibana

## Steps

The investigation followed a rigorous, multi-stage forensic process to reconstruct the incident timeline and identify adversary actions:

1. Attack Replication & Artifact Collection

- Initiated full-spectrum network packet capture on the victim system prior to launching reconnaissance and exploitation from the attacker machine (Kali Linux).

- Targeted vulnerabilities included ProFTPD exploit and application-level SQL injection to gain remote access.

- Captured critical forensic artifacts—a memory dump and a complete hard disk image—immediately following post-exploitation activities to ensure data integrity.

2. Network Forensic Analysis (Security Onion / Kibana)

- Analyzed collected PCAP files in Security Onion, correlating network events with security alerts generated by Snort IDS.

  <img width="419" height="363" alt="image" src="https://github.com/user-attachments/assets/950cdad8-867e-46ad-a115-799e56f69c88" />

Ref 1: Security Onion Case Events

- Successfully identified the initial payload transfer and analyzed C2 traffic patterns.

- Used Kibana for detailed visualization of network flows, confirming data exfiltration attempts between the attacker and victim IPs.


<img width="419" height="363" alt="image" src="https://github.com/user-attachments/assets/49b9e857-320d-4250-894d-18a7749dd704" />

Ref 2: Kibana Analysis

- Leveraged Cyberchef to decode and analyze HTTP traffic related to the SQL injection payload.

3. Memory Forensic Analysis (Volatility 3)

- Conducted deep-dive memory analysis on the acquired memory dump using Volatility 3.

- Executed commands such as pslist, psAux, and pstree to map the malicious process hierarchy and identify the parent process of the shell utilized by the attacker.

- Used malfind and dlldump to search for code injection or concealed malicious executables in process memory regions.

  <img width="419" height="363" alt="image" src="https://github.com/user-attachments/assets/c14e4eda-18c2-40cb-a6cb-5eaf592ede30" />

Ref 3: Memory Mapping Analysis to detect Malware

- Identified command-line history (via the cmdline plugin) used to execute system commands and perform privilege escalation attempts.

4. Disk & Timeline Analysis (Autopsy)

- Ingested the hard disk image into Autopsy to examine persistent changes and user activities.

- Performed file system analysis to confirm user creation, file manipulation, and the successful execution of local password cracking tools (Hashcat).

- Constructed a unified attack timeline using metadata, shell history logs, and file access times to chronologically map all post-exploitation actions.


 <img width="419" height="363" alt="image" src="https://github.com/user-attachments/assets/90ca8d80-7fd1-494b-83d4-3846849dcc69" />

Ref 4: Autopsy Timeline View

5. Incident Reconstruction & Reporting

- Correlated findings across all three domains (Network, Memory, Disk) to produce a definitive Incident Reconstruction Report.

- Mapped confirmed attacker actions, such as initial access and persistence, to the appropriate tactics and techniques within the MITRE ATT&CK framework.

- Concluded with recommendations for immediate mitigation steps and future security control hardening, prioritizing the identified vulnerabilities.



Ref 4: Autopsy Timeline View
